<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!--                                             -->
<!-- Author: ROOT team (rootdev@hpsalo.cern.ch)  -->
<!--                                             -->
<!--   Date: Fri Dec 20 16:02:44 2002            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>TCones - source file</title>
<link rev=made href="mailto:rootdev@root.cern.ch">
<meta name="rating" content="General">
<meta name="objecttype" content="Manual">
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers">
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis.">
</head>
<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#551a8b" ALINK="#ff0000" TEXT="#000000">
<a name="TopOfPage"></a>
<pre>
<b>//--------------------------------------------------------------------------</b>
<b>// File and Version Information:</b>
<b>// 	$Id: <a href=".././TCones.html">TCones</a>.h</b>
<b>//</b>
<b>// Description:</b>
<b>//      Class <a href=".././TCones.html">TCones</a> -  </b>
<b>//</b>
<b>// Environment:</b>
<b>//	Software developed for the BaBar Detector at the SLAC B-Factory.</b>
<b>//</b>
<b>// Author List:</b>
<b>//      Gianluca Cavoto                   Original author</b>
<b>//      Peter Sanders</b>
<b>//</b>
<b>// Copyright Information:</b>
<b>//</b>
<b>// ROOT Version by Marcel Kunze, RUB</b>
<b>//------------------------------------------------------------------------</b>

#include "RhoTools/TCones.h"
#include &lt;math.h&gt;
#include "RhoBase/TRho.h"
#include "RhoBase/TCandList.h"
#include "RhoBase/TCandListIterator.h"
#include "RhoBase/TEventInfo.h"
#include "TLorentzVector.h"

ClassImp(TCones)

TBuffer &amp;operator&gt;&gt;(TBuffer &amp;buf, TCones *&amp;obj)
{
   obj = (TCones *) buf.ReadObject(TCones::Class());
   return buf;
}

#include &lt;iostream&gt;
using namespace std;

<a name="TCones:TCones"> </a>TCones::TCones(TCandList * all_list, 
		   const TCandidate * thedaugh , 
		   const TEventInfo * evtinfo, int nbrcones) 
  : _numberOfCones(nbrcones) { 

  TLorentzVector cmsdaugh(thedaugh-&gt;P4());
  cmsdaugh.Boost(-(evtinfo-&gt;CmFrame().BoostVector()) );
  TVector3  direction(cmsdaugh.X(),cmsdaugh.Y(),cmsdaugh.Z());
  _directionUnit = direction.Unit();
  MakeCones(  all_list,  evtinfo);
}


<a name="TCones:TCones"> </a>TCones::TCones(TCandList * all_list, 
		   const TVector3  direction , 
		   const TEventInfo * evtinfo, int nbrcones) 
  : _numberOfCones(nbrcones){  

  
 
  _directionUnit = direction.Unit();
  MakeCones( all_list,  evtinfo);

}

<b>//--------------</b>
<b>// Destructor --</b>
<b>//--------------</b>

<a name="TCones:~TCones"> </a><a href=".././TCones.html">TCones</a>::~<a href=".././TCones.html">TCones</a>()
{
}

<a href="../ListOfTypes.html#double">double</a>
<a name="TCones:EnergyFlows"> </a><a href=".././TCones.html#TCones:EnergyFlows">TCones::EnergyFlows</a>(<a href="../ListOfTypes.html#int">int</a> order) 
{
  return <a href=".././TCones.html#TCones:_eflowarray">_eflowarray</a>(order-1);
}

<a href="../ListOfTypes.html#double">double</a>
<a name="TCones:MomentumFlows"> </a><a href=".././TCones.html#TCones:MomentumFlows">TCones::MomentumFlows</a>(<a href="../ListOfTypes.html#int">int</a> order) 
{
  return <a href=".././TCones.html#TCones:_mflowarray">_mflowarray</a>(order-1);
}

<a href="../ListOfTypes.html#int">int</a>
<a name="TCones:NumberOfCones"> </a><a href=".././TCones.html#TCones:NumberOfCones">TCones::NumberOfCones</a>()
{
  return <a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>;
}


<a href="../ListOfTypes.html#void">void</a> 
<a name="TCones:MakeCones"> </a><a href=".././TCones.html#TCones:MakeCones">TCones::MakeCones</a>(TCandList * all_list, 
		    const TEventInfo * evtinfo ){

<b>  // zero the vectors of energy and momentum</b>
  TVector initialize(<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>);
  for (<a href="../ListOfTypes.html#int">int</a> n=0; n&lt;=<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>; n++) {initialize(n) = 0.0;}   
  <a href=".././TCones.html#TCones:_eflowarray">_eflowarray</a> = initialize;
  <a href=".././TCones.html#TCones:_mflowarray">_mflowarray</a> = initialize;

<b>  // for speed calculate all the cone cosines</b>
  TVector cosinearray(<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>+1);
  for (<a href="../ListOfTypes.html#int">int</a> icone=0;icone&lt;<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>+1;++icone){
    cosinearray(icone) = cos( (<a href="../ListOfTypes.html#double">double</a>) icone*TMath::Pi()/<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a> );
  }
<b>  // avoid end affects </b>
  cosinearray(0)=1.1;
  cosinearray(<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>+1)=-1.1;
  

<b>  // iterate over candidates</b>
  TCandListIterator itercand( *all_list ); 
  TCandidate * onecand;

  while(onecand = itercand.Next()){

    TLorentzVector cms4Vec(onecand-&gt;P4());
    cms4Vec.Boost(-(evtinfo-&gt;CmFrame().BoostVector()) );
    TVector3 cms3Vec(cms4Vec.X(),cms4Vec.Y(),cms4Vec.Z());
     
    <a href="../ListOfTypes.html#double">double</a> cosangle = cms3Vec.Unit() * <a href=".././TCones.html#TCones:_directionUnit">_directionUnit</a>;
     
    for (<a href="../ListOfTypes.html#int">int</a> icone=0; icone&lt;<a href=".././TCones.html#TCones:_numberOfCones">_numberOfCones</a>; ++icone){
       
<b>      // increment the appropriate angular bin</b>
       
      if (cosangle &gt;  cosinearray(icone+1) &amp;&amp;
	  cosangle &lt;= cosinearray(icone) ) {
	 
	<a href=".././TCones.html#TCones:_eflowarray">_eflowarray</a>(icone) += cms4Vec.T();   // increment energy
	<a href=".././TCones.html#TCones:_mflowarray">_mflowarray</a>(icone) += cms3Vec.Mag(); // increment momentum
      }
       
    }      
  } // while
   
}


</pre>

<!--SIGNATURE-->
<br>
<hr>
<center>
<address>
<a href="http://root.cern.ch/root/Welcome.html">ROOT page</a> - <a href="../ClassIndex.html">Class index</a> - <a href="#TopOfPage">Top of the page</a><br>
</address>
</center>
<hr>
<address>
This page has been automatically generated. If you have any comments or suggestions about the page layout send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>, or contact <a href="mailto:rootdev@root.cern.ch">the developers</a> with any questions or problems regarding ROOT.
</address>
</body>
</html>
