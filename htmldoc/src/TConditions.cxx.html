<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!--                                             -->
<!-- Author: ROOT team (rootdev@hpsalo.cern.ch)  -->
<!--                                             -->
<!--   Date: Fri Dec 20 16:02:43 2002            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>TConditions - source file</title>
<link rev=made href="mailto:rootdev@root.cern.ch">
<meta name="rating" content="General">
<meta name="objecttype" content="Manual">
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers">
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis.">
</head>
<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#551a8b" ALINK="#ff0000" TEXT="#000000">
<a name="TopOfPage"></a>
<pre>
<b>//////////////////////////////////////////////////////////////////////////</b>
<b>//                                                                      //</b>
<b>// <a href=".././TConditions.html">TConditions</a>	    							//</b>
<b>//                                                                      //</b>
<b>// Conditions database class						//</b>
<b>//                                                                      //</b>
<b>// Author: Marcel Kunze, RUB, Nov. 99					//</b>
<b>// Copyright (C) 1999-2001, Ruhr-University Bochum.			//</b>
<b>//                                                                      //</b>
<b>//////////////////////////////////////////////////////////////////////////</b>

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
#include "TString.h"
#include "TBtree.h"
#include "TTree.h"
#include "TKey.h"
#include "TNetFile.h"
#include "TAuthenticate.h"

#include "RhoConditions/TConditions.h"
#include "RhoConditions/TBeams.h"
#include "RhoConditions/TDchCond.h"
#include "RhoConditions/TSvtPidCalib.h"

ClassImp(TConditions)

#include &lt;iostream&gt;
using namespace std;

<b>// Constructor</b>

<b>// The default location of the conditions database is expected</b>
<b>// at $TROOT/BaBarConditions.root</b>
<b>// Network access is supported via TNetFile</b>

<a name="TConditions:TConditions"> </a><a href=".././TConditions.html#TConditions:TConditions">TConditions::TConditions</a>(const <a href="../ListOfTypes.html#char">char</a> *db, const <a href="../ListOfTypes.html#char">char</a> *calibration, const <a href="../ListOfTypes.html#char">char</a> *bcalibration) :
<a href=".././TConditions.html#TConditions:fBeam">fBeam</a>(0),<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>(0),<a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>(0),<a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a>(0),<a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a>(0),<a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a>(0),
<a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a>(0), <a href=".././TConditions.html#TConditions:fReadBeams">fReadBeams</a>(kFALSE), <a href=".././TConditions.html#TConditions:fReadDchCond">fReadDchCond</a>(kFALSE),
<a href=".././TConditions.html#TConditions:fReadPepEnergies">fReadPepEnergies</a>(kFALSE), <a href=".././TConditions.html#TConditions:fReadPepBeamSpotCal">fReadPepBeamSpotCal</a>(kFALSE), <a href=".././TConditions.html#TConditions:fReadPepFillPattern">fReadPepFillPattern</a>(kFALSE),
<a href=".././TConditions.html#TConditions:fReadPepBoostCal">fReadPepBoostCal</a>(kFALSE), <a href=".././TConditions.html#TConditions:fReadSvtPidCalib">fReadSvtPidCalib</a>(kFALSE)
{
    TString baseDir = "";
    if (getenv("BFROOT")!=0) baseDir = TString(getenv("BFROOT"))+"/kanga";
    if (getenv("RHOROOT")!=0) baseDir = getenv("RHOROOT");
    
    if (baseDir.Index("root:")&gt;=0) <a href="#TConditions:Authorize">Authorize</a>();

    TString name(db);

<b>    // Special treatment of BFROOT</b>
    if (name.Index("BFROOT")&gt;=0) {
	if (getenv("BFROOT")) {
	    if (name.Index("$env(BFROOT)")&gt;=0) name = getenv("BFROOT") + name(12,name.Length()-12);
	    if (name.Index("$BFROOT")&gt;=0) name = getenv("BFROOT") + name(7,name.Length()-7);
	}
	else {
	    name = "CondDB/BaBarConditions.root";
	    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: BFROOT not set. Try to open " &lt;&lt; name &lt;&lt; endl;

	}
    }

    if (name == "") name = "CondDB/BaBarConditions.root";
    if (name.Data()[0] != '/' &amp;&amp; name.Data()[0] != '$' &amp;&amp; name.Data()[1] != ':') 
	name = baseDir + "/" + name;

    <a href=".././TConditions.html#TConditions:fFile">fFile</a> = TFile::Open(name, "READ","BaBar Conditions Data",1);
    if (<a href=".././TConditions.html#TConditions:fFile">fFile</a> == 0)
	cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error opening conditions file " &lt;&lt; name.Data() &lt;&lt; endl;
    else
	cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Opening conditions file " &lt;&lt; name.Data() &lt;&lt; endl;
    
    if (<a href=".././TConditions.html#TConditions:fFile">fFile</a> != 0) {
	
	<a href=".././TConditions.html#TConditions:fBeam">fBeam</a> = new <a href=".././TBeams.html">TBeams</a>();

<b>	// Browse the conditions file to see what containers it has, and create</b>
<b>	// appropriate proxies for each one</b>
	TList *keys= <a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;GetListOfKeys();
	<a href="../ListOfTypes.html#int">int</a> nContainers= keys-&gt;GetSize()/2;
	for(<a href="../ListOfTypes.html#int">int</a> index= 0; index &lt; nContainers; index++) {
	    TKey *key= (TKey*)(keys-&gt;<a href="#TConditions:At">At</a>(2*index+1));
	    const <a href="../ListOfTypes.html#char">char</a> *className= key-&gt;GetTitle();
	    TString keyName = key-&gt;GetName();
	    if(strcmp(className,"<a href=".././PepBeamsR.html">PepBeamsR</a>") == 0) {
<b>		// Setup the PepBeams interface</b>
		
		<a href=".././TConditions.html#TConditions:fBeamIndex">fBeamIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("PepBeamsRIndex");
		<a href=".././TConditions.html#TConditions:fBeamTree">fBeamTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("<a href=".././PepBeamsR.html">PepBeamsR</a>");
		if (<a href=".././TConditions.html#TConditions:fBeamTree">fBeamTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fBeamTree">fBeamTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fBeam">fBeam</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadBeams">fReadBeams</a> = kTRUE;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadBeams">fReadBeams</a> = kFALSE;
		}
	    }
	    else if(strcmp(className, "<a href=".././PepEnergiesR.html">PepEnergiesR</a>") == 0) {
<b>		// Setup the <a href=".././PepEnergiesR.html">PepEnergiesR</a> interface</b>
		
		<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a> = new <a href=".././PepEnergiesR.html">PepEnergiesR</a>();
		<a href=".././TConditions.html#TConditions:fPepEnergiesIndex">fPepEnergiesIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("PepEnergies_PEPIIIndex");
		<a href=".././TConditions.html#TConditions:fPepEnergiesTree">fPepEnergiesTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("PepEnergies_PEPII");
		if (<a href=".././TConditions.html#TConditions:fPepEnergiesTree">fPepEnergiesTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fPepEnergiesTree">fPepEnergiesTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepEnergies">fReadPepEnergies</a> = kTRUE;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepEnergies">fReadPepEnergies</a> = kFALSE;
		}
	    }
	    else if(strcmp(className, "<a href=".././PepBeamSpotCalR.html">PepBeamSpotCalR</a>") == 0) {
	      TString calName = TString("PepBeamSpotCal_") + TString(calibration);
	      if (keyName == calName) {
		<a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a> = new <a href=".././PepBeamSpotCalR.html">PepBeamSpotCalR</a>();
		TString index = calName + "Index";
		<a href=".././TConditions.html#TConditions:fPepBeamSpotCalIndex">fPepBeamSpotCalIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(index);
		<a href=".././TConditions.html#TConditions:fPepBeamSpotCalTree">fPepBeamSpotCalTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(calName);
		if (<a href=".././TConditions.html#TConditions:fPepBeamSpotCalTree">fPepBeamSpotCalTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fPepBeamSpotCalTree">fPepBeamSpotCalTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; calName.Data() &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepBeamSpotCal">fReadPepBeamSpotCal</a> = kTRUE;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepBeamSpotCal">fReadPepBeamSpotCal</a> = kFALSE;
		}
	      }
	    }
	    else if(strcmp(className, "<a href=".././PepFillPatternR.html">PepFillPatternR</a>") == 0) {
<b>		// Setup the <a href=".././PepFillPatternR.html">PepFillPatternR</a> interface</b>
		
		<a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a> = new <a href=".././PepFillPatternR.html">PepFillPatternR</a>();
		<a href=".././TConditions.html#TConditions:fPepFillPatternIndex">fPepFillPatternIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("PepFillPatternRIndex");
		<a href=".././TConditions.html#TConditions:fPepFillPatternTree">fPepFillPatternTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("<a href=".././PepFillPatternR.html">PepFillPatternR</a>");
		if (<a href=".././TConditions.html#TConditions:fPepFillPatternTree">fPepFillPatternTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fPepFillPatternTree">fPepFillPatternTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; className &lt;&lt; endl;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepFillPattern">fReadPepFillPattern</a> = kFALSE;
		}
	    }
	    else if(strcmp(className, "<a href=".././PepBoostCalR.html">PepBoostCalR</a>") == 0) {
	      TString calName = TString("PepBoostCal_") + TString(bcalibration);
	      if (keyName == calName) {
		<a href=".././TConditions.html#TConditions:fPepBoostCal">fPepBoostCal</a> = new <a href=".././PepBoostCalR.html">PepBoostCalR</a>();
		TString index = calName + "Index";
		<a href=".././TConditions.html#TConditions:fPepBoostCalIndex">fPepBoostCalIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(index);
		<a href=".././TConditions.html#TConditions:fPepBoostCalTree">fPepBoostCalTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(calName);
		<a href=".././TConditions.html#TConditions:fReadPepBoostCal">fReadPepBoostCal</a> = kTRUE;
		if (<a href=".././TConditions.html#TConditions:fPepBoostCalTree">fPepBoostCalTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fPepBoostCalTree">fPepBoostCalTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fPepBoostCal">fPepBoostCal</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; calName.Data() &lt;&lt; endl;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadPepBoostCal">fReadPepBoostCal</a> = kFALSE;
		}
	      }
	    }
	    else if(strcmp(className, "<a href=".././DchBetheBlochR.html">DchBetheBlochR</a>") == 0) {
<b>		// Setup the DchCond interface</b>
		
		<a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a> = new <a href=".././TDchCond.html">TDchCond</a>();
		<a href=".././TConditions.html#TConditions:fDchCondIndex">fDchCondIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("DchBetheBlochRIndex");
		<a href=".././TConditions.html#TConditions:fDchCondTree">fDchCondTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get("<a href=".././DchBetheBlochR.html">DchBetheBlochR</a>");
		if (<a href=".././TConditions.html#TConditions:fDchCondTree">fDchCondTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fDchCondTree">fDchCondTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadDchCond">fReadDchCond</a> = kTRUE;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadDchCond">fReadDchCond</a> = kFALSE;
		}
	    }
	    else if(strcmp(className, "<a href=".././SvtPidSimpleTMCalibR.html">SvtPidSimpleTMCalibR</a>") == 0) {		
	      if (keyName == "SvtPidCalibP:HitTwoSide") {
		<a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a> = new <a href=".././TSvtPidCalib.html">TSvtPidCalib</a>();
		TString index = TString(keyName) + "Index";
		<a href=".././TConditions.html#TConditions:fSvtPidCalibIndex">fSvtPidCalibIndex</a>= (TBtree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(index);
		<a href=".././TConditions.html#TConditions:fSvtPidCalibTree">fSvtPidCalibTree</a>= (TTree*)<a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Get(keyName);
		<a href=".././TConditions.html#TConditions:fReadSvtPidCalib">fReadSvtPidCalib</a> = kTRUE;
		if (<a href=".././TConditions.html#TConditions:fSvtPidCalibTree">fSvtPidCalibTree</a> != 0) {
		    <a href=".././TConditions.html#TConditions:fSvtPidCalibTree">fSvtPidCalibTree</a>-&gt;SetBranchAddress("data", &amp;<a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a>);
		    cout &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Setting TTree for " &lt;&lt; keyName.Data() &lt;&lt; endl;
		}
		else {
		    cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Error setting TTree for " &lt;&lt; className &lt;&lt; endl;
		    <a href=".././TConditions.html#TConditions:fReadSvtPidCalib">fReadSvtPidCalib</a> = kFALSE;
		}
	      }
	    }
	}
    }
    
}

<a name="TConditions:~TConditions"> </a><a href=".././TConditions.html">TConditions</a>::~<a href=".././TConditions.html">TConditions</a>() 
{
    delete <a href=".././TConditions.html#TConditions:fBeam">fBeam</a>;
    delete <a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>;
    delete <a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>;
    delete <a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a>;
    delete <a href=".././TConditions.html#TConditions:fPepBoostCal">fPepBoostCal</a>;
    delete <a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a>;
    delete <a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a>;
    <a href=".././TConditions.html#TConditions:fFile">fFile</a>-&gt;Close(); 
}

<b>// Trigger the input of a suiting beam info object</b>
<b>// Time is given in seconds since 1/1/1901</b>

<a name="TConditions:At"> </a><a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href=".././TConditions.html#TConditions:At">TConditions::At</a>(<a href=".././TRhoTime.html">TRhoTime</a> t)
{
    return <a href="#TConditions:At">At</a>(t.Seconds());
}

<a name="TConditions:At"> </a><a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href=".././TConditions.html#TConditions:At">TConditions::At</a>(<a href="../ListOfTypes.html#ULong_t">ULong_t</a> when) {
    
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> valid = kFALSE;
    
    TCondKey key(when);
    
<b>    // Read beam info</b>
    
    if (<a href=".././TConditions.html#TConditions:fReadPepEnergies">fReadPepEnergies</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fPepEnergiesIndex">fPepEnergiesIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fPepEnergiesTree">fPepEnergiesTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading PepEnergies index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    if (<a href=".././TConditions.html#TConditions:fReadPepBeamSpotCal">fReadPepBeamSpotCal</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fPepBeamSpotCalIndex">fPepBeamSpotCalIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fPepBeamSpotCalTree">fPepBeamSpotCalTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading PepBeamSpotCal index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    if (<a href=".././TConditions.html#TConditions:fReadPepFillPattern">fReadPepFillPattern</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fPepFillPatternIndex">fPepFillPatternIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fPepFillPatternTree">fPepFillPatternTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading PepFillPattern index  at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    if (<a href=".././TConditions.html#TConditions:fReadPepBoostCal">fReadPepBoostCal</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fPepBoostCalIndex">fPepBoostCalIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fPepBoostCalTree">fPepBoostCalTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading PepBoostCal index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    if (<a href=".././TConditions.html#TConditions:fReadBeams">fReadBeams</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fBeamIndex">fBeamIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fBeamTree">fBeamTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading beam index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    else {
<b>	// The new conditions data holds energy and calibration</b>
	if (<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>!=0 &amp;&amp; <a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>!=0)
	  <a href=".././TConditions.html#TConditions:fBeam">fBeam</a>-&gt;<a href=".././TBeams.html#TBeams:Update">Update</a>(*<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>,*<a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>);
	else
	  cerr &lt;&lt; "<a href=".././TConditions.html">TConditions</a>: Could not update <a href=".././TBeams.html">TBeams</a>" &lt;&lt; endl;
    }

    
<b>    // Read Dch info</b>
    
    if (<a href=".././TConditions.html#TConditions:fReadDchCond">fReadDchCond</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fDchCondIndex">fDchCondIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fDchCondTree">fDchCondTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading DchCond index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    
<b>    // Read SVT info</b>
    
    if (<a href=".././TConditions.html#TConditions:fReadSvtPidCalib">fReadSvtPidCalib</a>) {
	const <a href=".././RooCondInterval.html">RooCondInterval</a>* entry= (const <a href=".././RooCondInterval.html">RooCondInterval</a>*)(<a href=".././TConditions.html#TConditions:fSvtPidCalibIndex">fSvtPidCalibIndex</a>-&gt;FindObject(&amp;key));
	if(entry!=0) {
	    <a href="../ListOfTypes.html#int">int</a> index = entry-&gt;index();
	    <a href=".././TConditions.html#TConditions:fSvtPidCalibTree">fSvtPidCalibTree</a>-&gt;GetEntry(index);
	    valid = kTRUE;
	    <a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a> = when;
	}
	else
	    cerr &lt;&lt; "Error in reading SvtPidCalib index at (UTC)" &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(when) &lt;&lt; endl;
    }
    
    
    return valid;
}

<a name="TConditions:Authorize"> </a><a href="../ListOfTypes.html#void">void</a> <a href=".././TConditions.html#TConditions:Authorize">TConditions::Authorize</a>(const <a href="../ListOfTypes.html#char">char</a> *u, const <a href="../ListOfTypes.html#char">char</a> *p)
{
<b>// Authorization for ROOTD might be explicit or by use of environment variables</b>

    TString user,passwd;

    if (u != 0)
       user = u;
    else
       if (getenv("RHOUSER")!=0)  user = getenv("RHOUSER");

    if (p != 0)
       passwd = p;
    else
       if (getenv("RHOPASSWD")!=0) passwd = getenv("RHOPASSWD");

    cout &lt;&lt; "<a href=".././TConditions.html#TConditions:Authorize">TConditions::Authorize</a> " &lt;&lt; user.Data() &lt;&lt; " for ROOTD access" &lt;&lt; endl;

    TAuthenticate::SetGlobalUser(user); 
    TAuthenticate::SetGlobalPasswd(passwd);
}

<b>// Print the conditions data</b>

<a name="TConditions:PrintOn"> </a><a href="../ListOfTypes.html#void">void</a> <a href=".././TConditions.html#TConditions:PrintOn">TConditions::PrintOn</a>(std::ostream&amp; o) const
{
    o &lt;&lt; endl;
    o &lt;&lt; "Conditions info at (UTC): " &lt;&lt; <a href=".././TRhoTime.html">TRhoTime</a>(<a href=".././TConditions.html#TConditions:fCurrentTime">fCurrentTime</a>) &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fBeam">fBeam</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fBeam">fBeam</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadPepEnergies">fReadPepEnergies</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fPepEnergies">fPepEnergies</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadPepBeamSpotCal">fReadPepBeamSpotCal</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fPepBeamSpotCal">fPepBeamSpotCal</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadPepFillPattern">fReadPepFillPattern</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fPepFillPattern">fPepFillPattern</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadPepBoostCal">fReadPepBoostCal</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fPepBoostCal">fPepBoostCal</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fPepBoostCal">fPepBoostCal</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadDchCond">fReadDchCond</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fDchCond">fDchCond</a> &lt;&lt; endl;
    if (<a href=".././TConditions.html#TConditions:fReadSvtPidCalib">fReadSvtPidCalib</a> &amp;&amp; <a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a>!=0) o &lt;&lt; *<a href=".././TConditions.html#TConditions:fSvtPidCalib">fSvtPidCalib</a> &lt;&lt; endl;
}


<b>// --------------------</b>
<b>// non-member functions</b>
<b>// --------------------</b>

std::ostream&amp;  operator &lt;&lt; (std::ostream&amp; o, const <a href=".././TConditions.html">TConditions</a>&amp; a) {a.<a href="#TConditions:PrintOn">PrintOn</a>(o); return o;}


ClassImp(<a href=".././RooCondInterval.html">RooCondInterval</a>)

<a href=".././RooCondInterval.html#RooCondInterval:RooCondInterval">RooCondInterval::RooCondInterval</a>()
{
<b>    // don't set valid bit in the default ctor</b>
}

<a href=".././RooCondInterval.html">RooCondInterval</a>::~<a href=".././RooCondInterval.html">RooCondInterval</a>() { }

<a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href=".././RooCondInterval.html#RooCondInterval:IsSortable">RooCondInterval::IsSortable</a>() const {
    return kTRUE;
}

<a href="../ListOfTypes.html#Int_t">Int_t</a> <a href=".././RooCondInterval.html#RooCondInterval:Compare">RooCondInterval::Compare</a>(const TObject* other) const {
    <a href="../ListOfTypes.html#UInt_t">UInt_t</a> key= other-&gt;GetUniqueID();
    if(key &lt; GetUniqueID()) return +1; // we are "larger" than the other object
    if(key &gt;= _end) return -1;  // we are "smaller" than the other object
    return 0; // we are "equal" to the other object
}


ClassImp(<a href=".././RooCondData.html">RooCondData</a>)

<a href=".././RooCondData.html#RooCondData:RooCondData">RooCondData::RooCondData</a>() { }

<a href=".././RooCondData.html">RooCondData</a>::~<a href=".././RooCondData.html">RooCondData</a>() { }

<a href="../ListOfTypes.html#Stat_t">Stat_t</a> <a href=".././RooCondData.html#RooCondData:Store">RooCondData::Store</a>(TBranch&amp; where) const {
    <a href="../ListOfTypes.html#Stat_t">Stat_t</a> index= where.GetEntries();
    where.Fill();
    return index;
}

</pre>

<!--SIGNATURE-->
<br>
<hr>
<center>
<address>
<a href="http://root.cern.ch/root/Welcome.html">ROOT page</a> - <a href="../ClassIndex.html">Class index</a> - <a href="#TopOfPage">Top of the page</a><br>
</address>
</center>
<hr>
<address>
This page has been automatically generated. If you have any comments or suggestions about the page layout send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>, or contact <a href="mailto:rootdev@root.cern.ch">the developers</a> with any questions or problems regarding ROOT.
</address>
</body>
</html>
