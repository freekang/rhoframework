<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!--                                             -->
<!-- Author: ROOT team (rootdev@hpsalo.cern.ch)  -->
<!--                                             -->
<!--   Date: Fri Dec 20 16:03:02 2002            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>TLorentzVectorErr - source file</title>
<link rev=made href="mailto:rootdev@root.cern.ch">
<meta name="rating" content="General">
<meta name="objecttype" content="Manual">
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers">
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis.">
</head>
<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#551a8b" ALINK="#ff0000" TEXT="#000000">
<a name="TopOfPage"></a>
<pre>
<b>//////////////////////////////////////////////////////////////////////////</b>
<b>//                                                                      //</b>
<b>// <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>		    					//</b>
<b>//                                                                      //</b>
<b>// LorentzVector w/ error						//</b>
<b>//                                                                      //</b>
<b>// Author: Marcel Kunze, RUB, Nov. 99					//</b>
<b>// Copyright (C) 1999-2001, Ruhr-University Bochum.			//</b>
<b>//                                                                      //</b>
<b>//////////////////////////////////////////////////////////////////////////</b>

#include "RhoMath/TLorentzVectorErr.h"
#include "RhoMath/TVectorErr.h"

ClassImp(TLorentzVectorErr)

TBuffer &amp;operator&gt;&gt;(TBuffer &amp;buf, TLorentzVectorErr *&amp;obj)
{
   obj = (TLorentzVectorErr *) buf.ReadObject(TLorentzVectorErr::Class());
   return buf;
}

#include &lt;iostream&gt;
using namespace std;

<a name="TLorentzVectorErr:TLorentzVectorErr"> </a>TLorentzVectorErr::TLorentzVectorErr(const TVectorErr &amp; p3, 
					 Double_t mass) :
TLorentzVector((const TVector3 &amp;)p3, sqrt(p3.Mag2() + mass * mass))
{ 
    fCovMatrix = new TError(4);
<b>    // The 3-vector part of the error, initialized as a 0-matrix, then copied </b>
<b>    // from p3:</b>
    static TMatrixD p4Err(4,4);
    <a href="../ListOfTypes.html#int">int</a> i, j;
    for (i = 0; i &lt; 3; ++i){
	for (j = i; j &lt; 3; ++j){  // start from j=i, since (i,j) = (j,i)
	    p4Err(i,j) = p3.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()(i,j);
	}
    }
    
<b>    // The energy part of the error:</b>
    const <a href="../ListOfTypes.html#Double_t">Double_t</a> energy = E();
    
    if (energy != 0){
	p4Err(4,4) = 0.0;
	for (<a href="../ListOfTypes.html#int">int</a> i = 0; i &lt; 3; ++i){
	    for (<a href="../ListOfTypes.html#int">int</a> j = 0; j &lt; 3; ++j){
		p4Err(4,4) += p3[i] * p3[j] *
		    p3.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()(i, j);
	    }
	}
	p4Err(4,4) /= (energy * energy);
    }
    
<b>    // The E-p correlated part of the error is</b>
<b>    // &lt;(E - &lt;E&gt;) (Pi - &lt;Pi&gt;)&gt; = dE/dPj Vjk dPi/dPk</b>
<b>    // Since dPi/dPk = delta_ik, we get dE/dPj Vji.</b>
    for (i = 0; i &lt; 3; ++i){
	for (j = 0; j &lt; 3; ++j){
	    p4Err(i,3) += p3(j) / energy * p3.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()(j,i);	
<b>	    // No need to switch indices for a TMatrixD, so no p4Err(4,i)</b>
	}
    }
    
    <a href="#TLorentzVectorErr:SetCovMatrix">SetCovMatrix</a>(p4Err);
}

<b>// argumentless constructor:</b>
<a name="TLorentzVectorErr:TLorentzVectorErr"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:TLorentzVectorErr">TLorentzVectorErr::TLorentzVectorErr</a>() : TLorentzVector() 
{
    <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = new <a href=".././TError.html">TError</a>(4);
}

<b>// auto casting constructor</b>
<a name="TLorentzVectorErr:TLorentzVectorErr"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:TLorentzVectorErr">TLorentzVectorErr::TLorentzVectorErr</a>(const TLorentzVector &amp;p) : 
TLorentzVector(p)	
{
    <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = new <a href=".././TError.html">TError</a>(4);
}

<a name="TLorentzVectorErr:TLorentzVectorErr"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:TLorentzVectorErr">TLorentzVectorErr::TLorentzVectorErr</a>(const TLorentzVector &amp;p, const <a href=".././TError.html">TError</a>&amp; covMat) : 
TLorentzVector(p)
{
    <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = new <a href=".././TError.html">TError</a>(covMat);
}

<b>// copy constructor</b>
<a name="TLorentzVectorErr:TLorentzVectorErr"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:TLorentzVectorErr">TLorentzVectorErr::TLorentzVectorErr</a>(const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v) : TLorentzVector(v)	
{
    <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = new <a href=".././TError.html">TError</a>(v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>());
}

<b>// assignment operator:</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:operator">TLorentzVectorErr::operator</a>=(const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v)
{
    if (this != &amp;v) {
	TLorentzVector::operator=(v);
	<a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = new <a href=".././TError.html">TError</a>(v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>());
    }
    return *this;
}


<b>// mathematical modifiers:</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:operator">TLorentzVectorErr::operator</a> - () {
    ((TLorentzVector)*this) *= -1.;
    return *this;  // <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> unaltered
}

<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:operator">TLorentzVectorErr::operator</a> += (const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v){
    TLorentzVector::operator+=(v);
    *<a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> += v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>();
    return *this;
}

<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:operator">TLorentzVectorErr::operator</a> -= (const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v){
    TLorentzVector::operator-=(v);
    *<a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> += v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>();
    return *this;
}

<b>//-------------------------------------------------------------</b>
<a href="../ListOfTypes.html#Double_t">Double_t</a> 
<a name="TLorentzVectorErr:DetermineChisq"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:DetermineChisq">TLorentzVectorErr::DetermineChisq</a>(const TLorentzVector&amp; refVector)
{
    static TVectorD temp(4);
    temp(0) = refVector.X()-this-&gt;X();
    temp(1) = refVector.Y()-this-&gt;Y();
    temp(2) = refVector.Z()-this-&gt;Z();
    temp(3) = refVector.T()-this-&gt;T();
    
    return <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a>-&gt;<a href=".././TError.html#TError:DetermineChisq">DetermineChisq</a>(temp);
}


<b>//-------------------------------------------------------------</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; 
<a name="TLorentzVectorErr:Transform"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:Transform">TLorentzVectorErr::Transform</a>(const TLorentzRotation&amp; rot) {
    TLorentzVector::<a href="#TLorentzVectorErr:Transform">Transform</a>(rot);
    *<a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a>-&gt;<a href=".././TError.html#TError:Similarity">Similarity</a>(rot);
    return *this;
}

<b>//-------------------------------------------------------------</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; 
<a name="TLorentzVectorErr:Transform"> </a><a href=".././TLorentzVectorErr.html#TLorentzVectorErr:Transform">TLorentzVectorErr::Transform</a>(const TRotation&amp; rot){
    TLorentzVector::<a href="#TLorentzVectorErr:Transform">Transform</a>(rot);
    static TMatrixD tempRot(4,4);
    
<b>    // Fill a 4x4 matrix from the 3x3 TRotation. Note that they use different</b>
<b>    // indexing schemes (!?@#$&amp;^*&amp;#$@#):</b>
    
    <a href="../ListOfTypes.html#int">int</a> row;
    <a href="../ListOfTypes.html#int">int</a> col;
    for (row = 0; row &lt; 3; ++row){   // 3 is the size of TRotation
	for (col = 0; col &lt; 3; ++col){ // (which provides no enum)
	    tempRot(row, col) = rot(row, col);
	}
    }
    
<b>    // fill the 4th row:</b>
    tempRot(3,3) = 1.0;
    for (col = 0; col &lt; 3; ++col){
	tempRot(3, col) = 0.0;
    }
    
<b>    // fill the 4th column:</b>
    for (row = 0; row &lt; 3; ++row){
	tempRot(row, 3) = 0.0;
    }
    
    *<a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a> = <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:fCovMatrix">fCovMatrix</a>-&gt;<a href=".././TError.html#TError:Similarity">Similarity</a>(tempRot);
    return *this;
}



<b>//-------------------------------------------------------------</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a> 
operator + (const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v, const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; w){
    <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a> ve(TLorentzVector(v.X()+w.X(),v.Y()+w.Y(),v.Z()+w.Z(),
	v.T()+w.T()),
	(v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()+w.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()));
    return ve;
}


<b>//-------------------------------------------------------------</b>
<a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a> 
operator - (const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; v, const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a>&amp; w){
    <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a> ve(TLorentzVector(v.X()-w.X(),v.Y()-w.Y(),v.Z()-w.Z(),
	v.T()-w.T()), 
	(v.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()+w.<a href="#TLorentzVectorErr:CovMatrix">CovMatrix</a>()));
    return ve;
}

<a name="TLorentzVectorErr:PrintOn"> </a><a href="../ListOfTypes.html#void">void</a> <a href=".././TLorentzVectorErr.html#TLorentzVectorErr:PrintOn">TLorentzVectorErr::PrintOn</a>(std::ostream &amp;out) const
{
    out &lt;&lt; X() &lt;&lt; "t" &lt;&lt; Y() &lt;&lt; "t" &lt;&lt; Z() &lt;&lt; "t" &lt;&lt; T();
}

std::ostream&amp; operator&lt;&lt;(std::ostream &amp; stream, const <a href=".././TLorentzVectorErr.html">TLorentzVectorErr</a> &amp; verr) { verr.<a href="#TLorentzVectorErr:PrintOn">PrintOn</a>(stream); return stream; }
</pre>

<!--SIGNATURE-->
<br>
<hr>
<center>
<address>
<a href="http://root.cern.ch/root/Welcome.html">ROOT page</a> - <a href="../ClassIndex.html">Class index</a> - <a href="#TopOfPage">Top of the page</a><br>
</address>
</center>
<hr>
<address>
This page has been automatically generated. If you have any comments or suggestions about the page layout send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>, or contact <a href="mailto:rootdev@root.cern.ch">the developers</a> with any questions or problems regarding ROOT.
</address>
</body>
</html>
