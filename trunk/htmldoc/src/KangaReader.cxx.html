<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!--                                             -->
<!-- Author: ROOT team (rootdev@hpsalo.cern.ch)  -->
<!--                                             -->
<!--   Date: Fri Dec 20 16:02:07 2002            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>KangaReader - source file</title>
<link rev=made href="mailto:rootdev@root.cern.ch">
<meta name="rating" content="General">
<meta name="objecttype" content="Manual">
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers">
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis.">
</head>
<body BGCOLOR="#ffffff" LINK="#0000ff" VLINK="#551a8b" ALINK="#ff0000" TEXT="#000000">
<a name="TopOfPage"></a>
<pre>
#ifndef KANGAREADER_H
#define KANGAREADER_H
<b>//////////////////////////////////////////////////////////////////////////</b>
<b>//                                                                      //</b>
<b>// <a href=".././KangaReader.html">KangaReader</a>								//</b>
<b>//                                                                      //</b>
<b>// Implementation of the PAF event reader classes			//</b>
<b>// This class reads the Kanga schema					//</b>
<b>//                                                                      //</b>
<b>// Author: Marcel Kunze, RUB, May 2000					//</b>
<b>// Copyright (C) 1999-2001, Ruhr-University Bochum.			//</b>
<b>//									//</b>
<b>//////////////////////////////////////////////////////////////////////////</b>

#include "RhoBase/VAbsReader.h"

class THashList;
class TCLonesArray;
class TTree;
class TTreeFormula;
class TList;
class TNode;

class VAbsBit;
class VAbsTag;
class VAbsMicroCandidate;
class PAFListBase;
class PAFStream;

class TCandList;
class VAbsTruth;
class PAFStream;

class PAFEventBase;
class PAFMcBase;
class PAFMcAssocBase;
class PAFCompAodBase;
class TPrintTree;

class EidInfoR;
class BtaCandAssocMapR;
class BtaCandListR;
class BtaCandPtrR;
class StdHepR;
class StdHepTrkR;

class TCandidate;

template &lt;class T&gt; class RooClonesVectorR;

class KangaReader : public VAbsReader {
    
public:
    KangaReader(const char *,const char *description="PAF Kanga Reader");
    virtual ~KangaReader( );
    
<b>    // Operations</b>

    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetVerbose">SetVerbose</a>(<a href="../ListOfTypes.html#Bool_t">Bool_t</a> yesNo = kTRUE) { <a href=".././KangaReader.html#KangaReader:fVerbose">fVerbose</a> = yesNo; }

    <a href=".././PAFStream.html">PAFStream</a>* <a href="#KangaReader:GetStream">GetStream</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> StreamNo);
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:SetStreamStatus">SetStreamStatus</a>(const <a href="../ListOfTypes.html#char">char</a> *stream,<a href="../ListOfTypes.html#Bool_t">Bool_t</a> status=kTRUE);
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitializeStreams">InitializeStreams</a>(<a href="../ListOfTypes.html#Bool_t">Bool_t</a> multi=kTRUE);

    <a href="../ListOfTypes.html#UInt_t">UInt_t</a>  <a href="#KangaReader:GetCurrentIndex">GetCurrentIndex</a>();
    <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:GetEvent">GetEvent</a>(<a href="../ListOfTypes.html#UInt_t">UInt_t</a> number);
    <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfCandidates">GetNumberOfCandidates</a>() const { return <a href="#KangaReader:GetNumberOfTracks">GetNumberOfTracks</a>(); }   
    <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfEventsProcessed">GetNumberOfEventsProcessed</a>() const;
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetRunNumber">GetRunNumber</a>() const;    
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetEventNumber">GetEventNumber</a>() const;    
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfTracks">GetNumberOfTracks</a>() const;   
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfChargedTracks">GetNumberOfChargedTracks</a>() const;   
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfNeutralTracks">GetNumberOfNeutralTracks</a>() const;   
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfMcTruthTracks">GetNumberOfMcTruthTracks</a>() const;
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfCandAssocs">GetNumberOfCandAssocs</a>() const;
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfLists">GetNumberOfLists</a>() const;
    virtual const <a href="../ListOfTypes.html#char">char</a>* <a href="#KangaReader:GetListName">GetListName</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i) const;
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetNumberOfComposites">GetNumberOfComposites</a>() const;
    virtual TCandidate&amp; <a href="#KangaReader:GetCompositeCandidate">GetCompositeCandidate</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i) const;
    virtual VAbsMicroCandidate&amp; <a href="#KangaReader:GetMicroCandidate">GetMicroCandidate</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i) const;

    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetMajorID">GetMajorID</a>() const;
    virtual <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href="#KangaReader:GetMinorID">GetMinorID</a>() const;
    
    virtual <a href=".././PAFEventBase.html">PAFEventBase</a>&amp; <a href="#KangaReader:GetHeader">GetHeader</a>() const;    
    virtual VAbsTag&amp;	  <a href="#KangaReader:GetTag">GetTag</a>() const;    
    virtual VAbsBit&amp;	  <a href="#KangaReader:GetBit">GetBit</a>() const;    
    virtual <a href=".././PAFListBase.html">PAFListBase</a>&amp;  <a href="#KangaReader:GetListBase">GetListBase</a>() const;
    virtual <a href=".././EidInfoR.html">EidInfoR</a>&amp;     <a href="#KangaReader:GetEidInfo">GetEidInfo</a>() const;
    
    virtual VAbsTruth&amp; <a href="#KangaReader:GetMcTruth">GetMcTruth</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> n);
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:CreateMcTruthList">CreateMcTruthList</a>();
    virtual <a href=".././PAFMcBase.html">PAFMcBase</a>&amp; <a href="#KangaReader:GetMcBase">GetMcBase</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> n) const;
    virtual <a href=".././PAFMcAssocBase.html">PAFMcAssocBase</a>&amp; <a href="#KangaReader:GetMcAssocBase">GetMcAssocBase</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i);
    virtual <a href=".././StdHepTrkR.html">StdHepTrkR</a>&amp; <a href="#KangaReader:GetStdHepTrk">GetStdHepTrk</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> n) const;
    virtual <a href=".././BtaCandAssocMapR.html">BtaCandAssocMapR</a>&amp; <a href="#KangaReader:GetCandAssocMap">GetCandAssocMap</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i) const;
    virtual <a href=".././BtaCandListR.html">BtaCandListR</a>&amp; <a href="#KangaReader:GetCandList">GetCandList</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i) const;

<b>    // Fill lists from micro</b>
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:Fill">Fill</a>( TCandList* );
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillCharged">FillCharged</a>( TCandList* );
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillNeutral">FillNeutral</a>( TCandList* );
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillFromList">FillFromList</a>(TCandList *l,const <a href="../ListOfTypes.html#char">char</a>* listname);
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillCompositeList">FillCompositeList</a>(TCandList *l,const <a href="../ListOfTypes.html#char">char</a>* listname);
    virtual <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillAllCompositeList">FillAllCompositeList</a>(TCandList *l);

<b>	// MC handling</b>
    <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillCanonicalMcTruthList">FillCanonicalMcTruthList</a>(TCandList *);
    <a href="../ListOfTypes.html#Int_t">Int_t</a> <a href="#KangaReader:FillMcTruthList">FillMcTruthList</a>(TCandList *);
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetPrintTree">SetPrintTree</a>(<a href=".././TPrintTree.html">TPrintTree</a>* tree) { <a href=".././KangaReader.html#KangaReader:fPrintTree">fPrintTree</a> = tree; }
    <a href=".././TPrintTree.html">TPrintTree</a> *<a href="#KangaReader:GetPrintTree">GetPrintTree</a>() const { return <a href=".././KangaReader.html#KangaReader:fPrintTree">fPrintTree</a>; }
<b>    // Helper functions</b>
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:LoadMcNodes">LoadMcNodes</a>( TList* mcList);
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:PrintMcList">PrintMcList</a>(TNode&amp; cand );
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:FillMcList">FillMcList</a>( TList&amp; list, TNode&amp; cand );
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:MakeNodeFromStdTrack">MakeNodeFromStdTrack</a>(<a href="../ListOfTypes.html#Int_t">Int_t</a> i, TNode*&amp; mother );

<b>    // Evaluation of tag based cuts</b>
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetTagFormula">SetTagFormula</a>(const <a href="../ListOfTypes.html#char">char</a>* expr);
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetBitFormula">SetBitFormula</a>(const <a href="../ListOfTypes.html#char">char</a>* expr);
    <a href="../ListOfTypes.html#Double_t">Double_t</a> <a href="#KangaReader:EvalTagFormula">EvalTagFormula</a>();
    <a href="../ListOfTypes.html#Double_t">Double_t</a> <a href="#KangaReader:EvalBitFormula">EvalBitFormula</a>();

private:
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitTagBranches">InitTagBranches</a>(TTree *theTree); // The <a href="../ListOfTypes.html#float">float</a> and <a href="../ListOfTypes.html#int">int</a> tag
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitBitBranches">InitBitBranches</a>(TTree *theTree); // The boolean tag
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitAodBranches">InitAodBranches</a>(TTree *theTree); // The micro DST
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitMapBranches">InitMapBranches</a>(TTree *theTree); // The candidate maps
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitCmpBranches">InitCmpBranches</a>(TTree *theTree); // The composite maps
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitMctBranches">InitMctBranches</a>(TTree *theTree); // The MC-Truth
    virtual <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:InitTruBranches">InitTruBranches</a>(TTree *theTree); // The MC-Truth

    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:makeCompBase_pid">makeCompBase_pid</a>(<a href=".././BtaCandPtrR.html">BtaCandPtrR</a> *bcp,<a href=".././PAFCompAodBase.html">PAFCompAodBase</a> &amp;dest);
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:makeCompBase_cluster">makeCompBase_cluster</a>(<a href=".././BtaCandPtrR.html">BtaCandPtrR</a> *bcp,<a href=".././PAFCompAodBase.html">PAFCompAodBase</a> &amp;dest);
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:makeCompBase_V0">makeCompBase_V0</a>(<a href=".././BtaCandPtrR.html">BtaCandPtrR</a> *bcp,<a href=".././PAFCompAodBase.html">PAFCompAodBase</a> &amp;dest);
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a> <a href="#KangaReader:CreateTCandList">CreateTCandList</a>(const <a href="../ListOfTypes.html#char">char</a>*);
 
    <a href=".././PAFMcAssocBase.html">PAFMcAssocBase</a> *<a href=".././KangaReader.html#KangaReader:fAss">fAss</a>; //! Temp. variable
    TList *<a href=".././KangaReader.html#KangaReader:fMcList">fMcList</a>; //! Temp. list

private:
#define NMCMAX 512
    Bool_t fUseStdHepTrack[NMCMAX]; //!Do not stream

protected:
    PAFEventBase    *fContent;		//!Persistent TAG and HDR
    VAbsBit	    *fBits;		//!Persistent BIT
    PAFListBase     *fAodListsComp;     //!Container for persistent composite lists  					     
    TClonesArray    *fAodListCharged,	//!Persistent AOD, charged part 
		    *fAodListNeutral;	//!Persistent AOD, neutral part
    TClonesArray    *fOwnList;		//!List to hold the MicroCandidates       
    Int_t	    fEntries;		//!Number of candidates
    TClonesArray    *fMctList;          //!Persistent MCT
    TClonesArray    *fAssList;          //!Persistent MCT associations
    Int_t           fNumMctTracks;	//!
    Int_t           fNumMcAssoc;		//!
    Int_t           fNumRecTracks;	//!
    Int_t           fNumMaps;		//!
    TClonesArray*   fPAFMcTruthList;    //!this list holds the VAbsTruth Objects. They are instantiated
<b>                                        // on demand, when FillMcTruthlist is called.</b>
<b>                                        // Every PAFMcTurth capsulates a single <a href=".././PAFMcBase.html">PAFMcBase</a> in PAFEvent::<a href=".././KangaReader.html#KangaReader:fMctList">fMctList</a></b>
<b>                                        // and privides mother/daughter access via pointers</b>
    <a href="../ListOfTypes.html#Int_t">Int_t</a>  <a href=".././KangaReader.html#KangaReader:fPAFMcTruthEntries">fPAFMcTruthEntries</a>;          //!number of valid entries in fVAbsTruthList.
<b>                                        // Set to -1 in this crazy Next/NextIter thing. (invalid flag for fMcTruthList)</b>
<b>                                        // After a call FillMcTruthlist() it is &gt;= 0.</b>
    <a href=".././EidInfoR.html">EidInfoR</a>     *<a href=".././KangaReader.html#KangaReader:fEidInfo">fEidInfo</a>;	 //!kanga EidInfo
    TClonesArray *<a href=".././KangaReader.html#KangaReader:fBtaMicroList">fBtaMicroList</a>; //!kanga <a href=".././BtaMicroCandR.html">BtaMicroCandR</a> objects
    TObjArray	 *<a href=".././KangaReader.html#KangaReader:fBtaCandList">fBtaCandList</a>;  //!kanga <a href=".././BtaCandListR.html">BtaCandListR</a> objects
    TObjArray	 *<a href=".././KangaReader.html#KangaReader:fBtaCompList">fBtaCompList</a>;	 //!kanga composite objects
    RooClonesVectorR&lt;<a href=".././BtaCandAssocMapR.html">BtaCandAssocMapR</a>&gt; *<a href=".././KangaReader.html#KangaReader:fBtaCandAssocMap">fBtaCandAssocMap</a>;  //!kanga BtaCandAssocMap objects
    <a href=".././StdHepR.html">StdHepR</a>      *<a href=".././KangaReader.html#KangaReader:fStdHepR">fStdHepR</a>;	 //!kanga <a href=".././StdHepR.html">StdHepR</a> object
    
    <a href=".././PAFStream.html">PAFStream</a>* <a href="#KangaReader:NewStream">NewStream</a>(const <a href="../ListOfTypes.html#char">char</a>* AFileNameBase, const <a href="../ListOfTypes.html#char">char</a>* ATreeName);

    TTreeFormula *<a href=".././KangaReader.html#KangaReader:fTagFormula">fTagFormula</a>;  //!Fromula to evaluate Tag				     
    TTreeFormula *<a href=".././KangaReader.html#KangaReader:fBitFormula">fBitFormula</a>;  //!Fromula to evaluate analysis bits				     
    TString      <a href=".././KangaReader.html#KangaReader:fTagExpr">fTagExpr</a>;      //!Dynamic tag formula				     
    TString      <a href=".././KangaReader.html#KangaReader:fBitExpr">fBitExpr</a>;      //!Dynamic tag formula				     
    TString      <a href=".././KangaReader.html#KangaReader:fPAFTagExpr">fPAFTagExpr</a>;   //!The PAF tag formula uses different syntax				     

    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fTagStream">fTagStream</a>;	//!read Tag			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fEidStream">fEidStream</a>;	//!read Eid			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fAodStream">fAodStream</a>;	//!read micro			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fMapStream">fMapStream</a>;	//!read candidate maps			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fCmpStream">fCmpStream</a>;	//!read candidate maps			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fMctStream">fMctStream</a>;	//!read MC-Truth			     
    <a href=".././PAFStream.html">PAFStream</a> *<a href=".././KangaReader.html#KangaReader:fTruStream">fTruStream</a>;	//!read MC-Truth			     
    THashList *<a href=".././KangaReader.html#KangaReader:fStreams">fStreams</a>;    //!list of <a href=".././PAFStream.html">PAFStream</a> objects
    <a href=".././TPrintTree.html">TPrintTree</a> *<a href=".././KangaReader.html#KangaReader:fPrintTree">fPrintTree</a>; //!prints MC input

    <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href=".././KangaReader.html#KangaReader:fTimeStampMajor">fTimeStampMajor</a>;	//!The timestamp (secs since 1/1/1901)
    <a href="../ListOfTypes.html#UInt_t">UInt_t</a> <a href=".././KangaReader.html#KangaReader:fTimeStampMinor">fTimeStampMinor</a>;	//!Nanos in sec

    <a href="../ListOfTypes.html#Int_t">Int_t</a>   <a href=".././KangaReader.html#KangaReader:fCounter">fCounter</a>;		//!Relative event counter (file)
    <a href="../ListOfTypes.html#Int_t">Int_t</a>   <a href=".././KangaReader.html#KangaReader:fTotal">fTotal</a>;		//!Absolute event counter
    <a href="../ListOfTypes.html#Int_t">Int_t</a>   <a href=".././KangaReader.html#KangaReader:fMaxC">fMaxC</a>,<a href=".././KangaReader.html#KangaReader:fMaxN">fMaxN</a>;        //!Length of longest charged/ 
<b>				//!neutral list in current Tree</b>
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a>  <a href=".././KangaReader.html#KangaReader:fTag">fTag</a>,<a href=".././KangaReader.html#KangaReader:fAod">fAod</a>,<a href=".././KangaReader.html#KangaReader:fMct">fMct</a>,<a href=".././KangaReader.html#KangaReader:fMap">fMap</a>,<a href=".././KangaReader.html#KangaReader:fCmp">fCmp</a>;//!stream status
    <a href="../ListOfTypes.html#Bool_t">Bool_t</a>  <a href=".././KangaReader.html#KangaReader:fVerbose">fVerbose</a>;		//!Debug
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetChargedTree">SetChargedTree</a>();
    <a href="../ListOfTypes.html#void">void</a> <a href="#KangaReader:SetNeutralTree">SetNeutralTree</a>();

    TClonesArray *<a href=".././KangaReader.html#KangaReader:fBtaList">fBtaList</a>; //! BABAR like McTruth association

public:
<b>    //ClassDef(<a href=".././KangaReader.html">KangaReader</a>,1) // Kanga implementation of <a href=".././PAFReader.html">PAFReader</a></b>
};


#endif





</pre>

<!--SIGNATURE-->
<br>
<hr>
<center>
<address>
<a href="http://root.cern.ch/root/Welcome.html">ROOT page</a> - <a href="../ClassIndex.html">Class index</a> - <a href="#TopOfPage">Top of the page</a><br>
</address>
</center>
<hr>
<address>
This page has been automatically generated. If you have any comments or suggestions about the page layout send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>, or contact <a href="mailto:rootdev@root.cern.ch">the developers</a> with any questions or problems regarding ROOT.
</address>
</body>
</html>
